@using UniOdonto.Models.Filters
@using MvcJqGrid
@using MvcJqGrid.Enums
@using RP.Website.Helpers


@{
    ViewBag.Title = "Importar";
    Layout = "~/Views/Shared/_EmpresaConfiguracionLayout.cshtml";
    ViewBag.Panel = "Importar";
}

<div role="tabpanel" class="tab-pane active">

    <div id="addContainer" class="row">
        <div class="col-md-10 col-md-offset-1">
            <div class="form-horizontal">
                <div class="form-group">
                    <div class="col-md-5">
                        <div class="input-group">
                            <input type="text" class="form-control" value="@ViewBag.Directorio" id="txtDirectorio" placeholder="Directorio de origen">
                            <span class="input-group-btn">
                                <button class="btn btn-primary" type="button" id="importar-desde-directorio">Importar</button>
                            </span>
                        </div>
                    </div>
                    <div class="col-md-6">
                        <span class="glyphicon glyphicon-info-sign"></span> Desde un directorio ubicado en el servidor
                    </div>
                </div>
                <div class="form-group">
                    <div class="col-md-5 ">
                        <button type="button" id="btnImportarMasivamente" class="btn btn-primary">
                            <i class="fa fa-upload"></i> Importar desde Archivo
                        </button>
                    </div>
                    <div class="col-md-6">
                        <span class="glyphicon glyphicon-info-sign"></span> Permite cargar un archivo .rar o .zip con los Xmls autorizados
                    </div>
                </div>
            </div>
        </div>
    </div>
    <div class="modal fade" id="importar-modal" tabindex="-1" role="dialog">
        <div class="modal-dialog modal-lg">
            <div class="modal-content">
                <div class="modal-header">
                    <h4 class="modal-title" id="myModalLabel">Importar Masivamente</h4> 
                </div>
                <form role="form" id="form-upload-file" action='@Url.Action("Save")'>
                    <div class="modal-body">
                        <div id="divFile">
                            <table class="table">
                                <tr>
                                    <td><input type="file" id="file" name="file" /></td>
                                    <td><span class="text-info">(.rar, .zip)</span></td>
                                </tr>
                            </table>
                        </div>
                        <div id="mensaje" role="alert" class="">
                            <h5 id="mensajeTitle">Cargando...</h5>
                            <div class="progress">
                                <div class="progress-bar progress-bar-striped active" role="progressbar" aria-valuenow="45" aria-valuemin="0" aria-valuemax="100" style="width: 45%">
                                </div>
                            </div>
                            <table class="table">
                                <tr>
                                    <td id="tdEstado" class="alert-info"></td>

                                </tr>
                                <tr>
                                    <td class="alert-danger">
                                        <div style="min-height: 250px; overflow: auto">
                                            <div id="tdErrores"></div>
                                        </div>
                                    </td>
                                </tr>
                            </table>
                        </div>
                        <div></div>
                    </div>
                    <div class="modal-footer">
                        <button type="button" id="importar-modal-close" class="btn btn-danger" data-dismiss="modal">Cerrar</button>
                        <button type="submit" id="importar-modal-cargar" class="btn btn-primary">Importar</button>
                        <button type="button" id="importar-modal-cancelar" class="btn btn-default">Cancelar</button>
                    </div>
                </form>
            </div>
        </div>
    </div>


    @section scripts
    {
        <script type="text/javascript" language="javascript" src="~/Scripts/jquery.signalR-2.1.2.js"></script>
        <!--Reference the autogenerated SignalR hub script. -->
        <script src="~/signalr/hubs"></script>
        <script type="text/javascript" language="javascript" src="~/Scripts/Pages/Importar.js"></script>
        <script language="javascript" type="text/javascript">
            url = "@Url.Action("ImportarMasivamente", "Empresas")";
            url2 = "@Url.Action("ImportarMasivamente2", "Empresas")";
            empresaId = "@ViewBag.id";
        </script>
    }
</div>